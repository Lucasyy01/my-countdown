<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的自由倒计时</title>
    <!-- 引入Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Inter字体 --><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            
            /* ✨ 新的CSS动态渐变背景 */
            background: linear-gradient(-45deg, #0b1c3d, #1d2b5a, #5a3c6a, #c06c84, #f8b195);
            background-size: 400% 400%;
            animation: gradientAnimation 25s ease infinite;
        }

        /* ✨ 动态背景的动画 */
        @keyframes gradientAnimation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* 倒计时加载动画 */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #fff; /* 适应深色背景 */
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        /* 确保在加载时，倒计时数字不可见，避免闪烁 */
        .countdown-container.loading .countdown-item {
            visibility: hidden;
        }
        /* 调整输入框日期文字颜色 */
        input[type="date"] {
            color-scheme: dark; /* 尝试让日期选择器适应深色主题 */
        }
        input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(1); /* 反转日历图标颜色 */
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- 视频背景已被删除 -->

    <div class="w-full max-w-3xl mx-auto bg-slate-900 bg-opacity-40 backdrop-blur-lg rounded-xl shadow-2xl p-6 md:p-10 text-center text-white relative z-10">
        
        <header class="mb-6">
            <h1 class="text-4xl md:text-5xl font-extrabold text-white drop-shadow-lg">
                我的自由倒计时
            </h1>
            <p id="sub-title" class="text-lg text-gray-200 mt-2"></p>
        </header>

        <!-- 日期设置区域 --><div class="flex flex-col sm:flex-row items-center justify-center gap-2 mb-8">
            <input 
                type="date" 
                id="target-date-input" 
                class="block w-full sm:w-auto px-4 py-3 text-base text-white bg-white bg-opacity-10 border border-white border-opacity-20 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-white placeholder-gray-300"
                aria-label="设置目标日期"
            >
            <button 
                id="set-date-button"
                class="w-full sm:w-auto px-6 py-3 bg-white bg-opacity-20 text-white font-semibold rounded-lg shadow-md hover:bg-white hover:bg-opacity-30 focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-75 transition-colors duration-200"
            >
                设置目标
            </button>
        </div>

        <!-- ✨ 新增的错误提示区域 --><div id="error-message" class="hidden text-red-300 text-sm mb-4"></div>

        <!-- 倒计时显示区域 --><div id="countdown-container" class="countdown-container loading">
            <!-- 加载指示器 --><div id="loader" class="loader mx-auto my-10" style="border-top-color: #fff;"></div>
            
            <!-- 倒计时数字 --><div class="flex justify-center text-center space-x-2 sm:space-x-4 countdown-item">
                <div class="bg-white bg-opacity-10 backdrop-blur-sm p-3 sm:p-6 rounded-lg shadow-lg w-1/4">
                    <div id="days" class="text-3xl sm:text-6xl font-bold text-white">0</div>
                    <div class="text-xs sm:text-sm text-gray-200 uppercase mt-1">天</div>
                </div>
                <div class="bg-white bg-opacity-10 backdrop-blur-sm p-3 sm:p-6 rounded-lg shadow-lg w-1/4">
                    <div id="hours" class="text-3xl sm:text-6xl font-bold text-white">0</div>
                    <div class="text-xs sm:text-sm text-gray-200 uppercase mt-1">小时</div>
                </div>
                <div class="bg-white bg-opacity-10 backdrop-blur-sm p-3 sm:p-6 rounded-lg shadow-lg w-1/4">
                    <div id="minutes" class="text-3xl sm:text-6xl font-bold text-white">0</div>
                    <div class="text-xs sm:text-sm text-gray-200 uppercase mt-1">分钟</div>
                </div>
                <div class="bg-white bg-opacity-10 backdrop-blur-sm p-3 sm:p-6 rounded-lg shadow-lg w-1/4">
                    <div id="seconds" class="text-3xl sm:text-6xl font-bold text-white">0</div>
                    <div class="text-xs sm:text-sm text-gray-200 uppercase mt-1">秒</div>
                </div>
            </div>
            
            <!-- 目标达成提示 --><div id="message" class="hidden mt-6 text-2xl font-bold text-green-300">
                🎉 目标达成！欢迎来到新生活！
            </div>
        </div>

        <!-- ✨ 修改后的金句展示区域 --><div id="daily-quote-container" class="hidden mt-12 cursor-pointer" title="点击刷新金句">
            <!-- 重新设计了卡片样式 --><div class="p-5 text-center transition-transform transform hover:scale-105">
                <h4 class="text-sm font-semibold text-gray-300 tracking-widest uppercase mb-3">✨ 点击刷新金句 ✨</h4>
                <p id="daily-quote-content" class="text-2xl md:text-3xl text-white font-medium leading-relaxed italic shadow-md">
                    <!-- 金句将在这里显示 --></p>
            </div>
        </div>


        <!-- 当前目标日期提示 --><footer class="mt-8">
            <p id="target-date-display" class="text-gray-300 text-sm">
                尚未设置目标日期
            </p>
        </footer>

    </div>

    <!-- ✨ Modal已被删除 --><script>
        // --- 倒计时元素 ---
        const targetDateInput = document.getElementById('target-date-input');
        const setDateButton = document.getElementById('set-date-button');
        const countdownContainer = document.getElementById('countdown-container');
        const loader = document.getElementById('loader');
        
        const daysEl = document.getElementById('days');
        const hoursEl = document.getElementById('hours');
        const minutesEl = document.getElementById('minutes');
        const secondsEl = document.getElementById('seconds');
        
        const messageEl = document.getElementById('message');
        const targetDateDisplay = document.getElementById('target-date-display');
        const subTitleEl = document.getElementById('sub-title');
        const errorMessageEl = document.getElementById('error-message');

        // --- ✨ 金句相关元素 ---
        const dailyQuoteContainer = document.getElementById('daily-quote-container');
        const dailyQuoteContent = document.getElementById('daily-quote-content');

        const STORAGE_KEY = 'myFreedomCountdownTarget';
        let targetDate = null;
        let countdownInterval = null;
        let currentQuoteIndex = -1; // ✨ 用于防止重复显示金句

        // --- ✨ 摩根·后塞尔金句库 ---
        const morganHouselQuotes = [
            "金钱最大的价值，是它能给你掌控自己时间的能力。",
            "存钱的意义不在于你非要买什么，而在于它能带给你的选项、独立和自由。",
            "真正的财富，是那些看不见的东西：是能和你爱的人共度时光，是能掌控自己的生活。",
            "致富和守富是两码事。致富需要冒险和乐观，而守富需要谦逊和恐惧。",
            "‘够了’是一个强大的概念。‘够了’意味着你停止移动那个贪婪的终点线。",
            "你的‘安全边际’越大，你就越能忍受波动，从而让复利这个奇迹有时间为你工作。",
            "不要为那些你不需要的东西，去赌上那些你拥有且需要的东西。",
            "世界上没有什么是免费的。成功的代价是显而易见的，但不确定性、怀疑和遗憾的代价同样真实。",
            "用金钱去获取对时间和生活的掌控感，是金钱能带来的最高红利。",
            "重要的不是你赚了多少，而是你存下了多少。储蓄率是你能完全掌控的。"
        ];

        // --- 倒计时逻辑 (原有) ---

        function updateCountdown() {
            if (!targetDate) return;

            const now = new Date().getTime();
            const distance = targetDate.getTime() - now;

            if (distance < 0) {
                // 倒计时结束
                clearInterval(countdownInterval);
                countdownContainer.style.display = 'none'; // 隐藏数字
                loader.style.display = 'none'; // 隐藏加载器
                messageEl.classList.remove('hidden'); // 显示完成信息
                subTitleEl.textContent = '欢迎开启新生活！';
                dailyQuoteContainer.classList.add('hidden'); // ✨ 结束后隐藏金句
                return;
            }

            // 计算时间
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // 更新DOM
            daysEl.textContent = days;
            hoursEl.textContent = hours;
            minutesEl.textContent = minutes;
            secondsEl.textContent = seconds;
            
            // 隐藏加载器，显示倒计时
            if (countdownContainer.classList.contains('loading')) {
                loader.style.display = 'none';
                countdownContainer.classList.remove('loading');
                // 让数字出现更平滑
                document.querySelectorAll('.countdown-item').forEach(el => {
                    el.style.visibility = 'visible';
                });
            }
        }

        /**
         * ✨ 修改：设置并保存新的目标日期
         */
        function setAndSaveDate() {
            const dateString = targetDateInput.value;
            errorMessageEl.classList.add('hidden'); // ✨ 先隐藏旧错误

            if (!dateString) {
                errorMessageEl.textContent = '请选择一个有效的日期！';
                errorMessageEl.classList.remove('hidden');
                return;
            }

            // 将日期设置为当天的开始，避免时区问题
            const [year, month, day] = dateString.split('-');
            targetDate = new Date(year, month - 1, day);
            
            // 检查日期是否合法
            if (isNaN(targetDate.getTime())) {
                errorMessageEl.textContent = '日期格式无效，请重新选择。';
                errorMessageEl.classList.remove('hidden');
                targetDate = null;
                return; // 退出，不重置
            }

            // 存储到localStorage
            localStorage.setItem(STORAGE_KEY, targetDate.toISOString());
            
            // 更新显示
            updateTargetDateDisplay();
            
            // 重置倒计时
            resetCountdown();
        }

        /**
         * ✨ 修改：更新底部目标日期的显示文字
         */
        function updateTargetDateDisplay() {
            if (targetDate) {
                // 格式化日期为 YYYY年MM月DD日
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                targetDateDisplay.textContent = `当前目标日期: ${targetDate.toLocaleDateString('zh-CN', options)}`;
            } else {
                targetDateDisplay.textContent = '尚未设置目标日期';
            }
        }

        /**
         * ✨ 修改：重置倒计时
         */
        function resetCountdown() {
            // 清除旧的计时器
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }
            
            // 隐藏完成信息，显示倒计时容器
            messageEl.classList.add('hidden');
            countdownContainer.style.display = 'block';
            
            // 显示加载器，隐藏数字
            loader.style.display = 'block';
            countdownContainer.classList.add('loading');
            document.querySelectorAll('.countdown-item').forEach(el => {
                el.style.visibility = 'hidden';
            });

            // 立即执行一次，然后每秒执行
            if (targetDate) {
                showRandomQuote(); // ✨ 修改：显示随机金句
                dailyQuoteContainer.classList.remove('hidden'); // ✨ 显示金句容器
                updateCountdown();
                countdownInterval = setInterval(updateCountdown, 1000);
            } else {
                // 如果没有目标日期，隐藏
                dailyQuoteContainer.classList.add('hidden'); // ✨ 隐藏金句容器
                loader.style.display = 'none';
                countdownContainer.classList.remove('loading');
            }
        }

        /**
         * ✨ 修改：页面加载时初始化
         */
        function init() {
            // 1. 添加按钮点击事件
            setDateButton.addEventListener('click', setAndSaveDate);
            
            // ✨ 2. 添加金句卡片点击事件
            dailyQuoteContainer.addEventListener('click', showRandomQuote);

            // 3. 尝试从localStorage加载日期
            const savedDateString = localStorage.getItem(STORAGE_KEY);
            if (savedDateString) {
                targetDate = new Date(savedDateString);
                
                // ✨ 新增：验证本地存储的日期
                if (isNaN(targetDate.getTime())) {
                    targetDate = null;
                    localStorage.removeItem(STORAGE_KEY); // 清除坏数据
                } else {
                    // 将保存的日期设置回输入框
                    targetDateInput.value = targetDate.toISOString().split('T')[0];
                }
            }

            // 4. 更新显示并启动倒计时
            updateTargetDateDisplay();
            resetCountdown();
        }

        // --- ✨ 显示每日金句 功能逻辑 ---

        /**
         * ✨ 修改：显示随机金句
         * 随机从金句库中选择一句，并避免连续重复
         */
        function showRandomQuote() {
            let newIndex = currentQuoteIndex;
            
            // 确保新索引与旧索引不同
            while (newIndex === currentQuoteIndex) {
                newIndex = Math.floor(Math.random() * morganHouselQuotes.length);
            }
            
            currentQuoteIndex = newIndex;
            const quote = morganHouselQuotes[currentQuoteIndex];
            
            // 显示内容
            dailyQuoteContent.textContent = `“${quote}”`;
        }

        // 启动应用
        init();
    </script>
</body>
</html>


